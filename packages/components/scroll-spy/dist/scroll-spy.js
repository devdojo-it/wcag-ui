require("./scroll-spy.css");var $895vp$wcaguicore=require("@wcag-ui/core"),$895vp$wcaguidom=require("@wcag-ui/dom");function $parcel$export(e,t,r,o){Object.defineProperty(e,t,{get:r,set:o,enumerable:!0,configurable:!0})}$parcel$export(module.exports,"ScrollSpy",()=>$47d87530ab6ae3ca$export$a6472a5298a374be);var $6fbf1c2fd670cf1d$export$2e2bcd8739ae039={target:function(e,t){}},$7c84922fb27fd9a5$export$2e2bcd8739ae039={};class $47d87530ab6ae3ca$export$a6472a5298a374be extends HTMLElement{static name="wcag-scroll-spy";static extends="aside";static attributes=$6fbf1c2fd670cf1d$export$2e2bcd8739ae039;static events=$7c84922fb27fd9a5$export$2e2bcd8739ae039;static{(0,$895vp$wcaguicore.componentDecorator)("ScrollSpy",$47d87530ab6ae3ca$export$a6472a5298a374be)}_observer=null;sections=[];constructor(){super()}onConnected(){let e=this.getAttribute("target"),t=document.querySelector(e);if(!t){console.error("Target container non trovato per ScrollSpy:",e);return}this.sections=[...t.querySelectorAll("section:has(> :where(h2, h3))")],this.buildNav(),this.setupObserver()}onDisconnected(){this._observer&&this._observer.disconnect()}buildNav(){let e=`
      <nav>
        <ul>
          ${this.sections.map(e=>(e.id||(e.id=e.querySelector("h2, h3").textContent.trim().toLowerCase().replace(/\s+/g,"-")),`<li><a href="#${e.id}">${e.querySelector("h2, h3").textContent}</a></li>`)).join("")}
        </ul>
      </nav>
    `;(0,$895vp$wcaguidom.DOM).insertHTML(e,this)}setupObserver(){for(let e of(this._observer=new IntersectionObserver(e=>{for(let t of e){let e=t.target.id,r=this.querySelector(`a[href="#${e}"]`);t.isIntersecting&&(this.clearActive(),r&&r.parentElement&&r.parentElement.classList.add("active"))}},{root:null,rootMargin:"0px",threshold:.5}),this.sections))this._observer.observe(e)}clearActive(){for(let e of this.querySelectorAll("li.active"))e.classList.remove("active")}}