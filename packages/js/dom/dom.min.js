let e=(e,t,n=!1,r=!1)=>{let o=[];for(;(!n||0===o.length)&&e!==document;)t?t instanceof Function?t(e)&&o.unshift(e):e instanceof Element&&e.matches&&e.matches(t)&&o.unshift(e):o.unshift(e),e.parentNode&&(e=e.parentNode);return!r&&o.indexOf(e)&&o.splice(o.indexOf(e),1),o},t=(e,n)=>{if(!n.textContent?.toLowerCase().includes(e.toLowerCase()))return[];[...n.childNodes].length;let r=[];for(let o of[...n.childNodes])r.push(...t(e,o));return r},n=Object.freeze({HTMLElement:1,ChildNode:3,Comment:8}),r=(e,t="")=>t&&e[t]?.trim().length>0,o=(e,t=[],o=[],l=!0)=>{let i=e.nodeType===n.ChildNode&&r(e,"textContent"),s=!t.includes(e.tag?.toLowerCase())&&r(e,"outerHTML"),a=!o.includes(e);return!!l&&e.nodeType===n.Comment||(i||s)&&a},l=(e,t=[],r=[],l="nextSibling")=>{let i=[],s=e;for(;s&&Object.values(n).includes(s.nodeType);)o(s,t,r)&&i.push(s),s=s[l];return i},i=(e,t)=>{let n=t.replace(/\s+/g,"").toLowerCase(),r=e.startsWith("on"),o=["src","href","xlink:href"].includes(e)&&(n.includes("javascript:")||n.includes("data:text/html"));return r||o},s=e=>{if(1===e.nodeType)for(let{name:t,value:n}of e.attributes)i(t,n)&&e.removeAttribute(t)},a=e=>{for(let t of e.childNodes)s(t),a(t)},c=(e,t=!1)=>{let n=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body");for(let e of(a(n),n?.querySelectorAll("script")??[]))e.remove();return t?n.childNodes:n.innerHTML},d=e=>{if(!e.tag)throw Error("wcag-ui.core.createElement error: no tag provided");let t=document.createElement(e.tag);for(let[n,r]of(e.classes&&t.classList.add(...e.classes),Object.entries(e.attributes??{})))t.setAttribute(n,r);let n=document.createDocumentFragment();return n.append(...c(e.content,!0)),e.content&&t.append(n),t},u=e=>e instanceof HTMLElement||e instanceof DocumentFragment?e:d(e),p=Object.freeze({before:"beforebegin",prepend:"afterbegin",append:"beforeend",after:"afterend"}),f=(e,t,n)=>{let r=u(e);return t.insertAdjacentElement(p[n],r),r},m={ancestor:(t,n="",r=!1)=>{let o=e(t,selector,!0,r);return o.length>0?o[0]:void 0},ancestors:e,containsHTML:e=>/<[a-z][\s\S]*>/i.test(e),findNodes:t,getAllSiblings:(e,t=[])=>l(e.parentNode?.firstChild,t,[e]),getPrevSiblings:(e,t=[])=>l(e.previousSibling,t,[],"previousSibling"),getNextSiblings:(e,t=[])=>l(e.nextSibling,t),outerHTML:(e,t=!1)=>t?e.outerHTML.replaceAll("\n","").replace(/(?<=<.*?>).*(?=<\/.*>)/gm,""):e.outerHTML,sanitizeHTML:c,insertHTML:(e,t,n,r=!1)=>{r&&(t.innerHTML="");let o=c(e,!0),l=document.createDocumentFragment();return l.append(...o),t[n??"append"](l),o},createFragment:(...e)=>{let t=document.createDocumentFragment();return t.append(...e),t},createElement:d,ensureElement:u,insertElement:f,wrapElement:(e,t)=>{let n=u(e),r=u(t);return r.isConnected||f(r,n,"before"),f(n,r,"append"),r}};export{m as DOM};